<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/html">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <link rel="stylesheet" href="style.css">

</head>
<body>

<a href="authForm.html">Authorization form</a><br>

<a href="records.html">Records</a>
<div class="app">
    <div class="info column">
        <h4 id="name">Player: </h4>
        <p>Next figure:</p>
        <div id="next-figure">
            <canvas id="next-figure-canvas" width="40" height="40"></canvas>
        </div>
        <p>
            Controls: </br>
            Left arrow - move figure into left </br>
            Right arrow - move figure into right </br>
            Up arrow - rotate figure </br>
            Bottom arrow - speed up figure </br>
        </p>
    </div>
    <div class="column">
        <canvas  id="canvas" width="100" height="300"></canvas>
    </div>
</div>

<script type="module" src="src/game.js"></script>

<script>

    const CURRENT_LOGGED_PLAYER = "currentLoggedPlayer";

    window.onload = (evt) => {
        const name = document.getElementById("name");

        let lastLogged = getCookie(CURRENT_LOGGED_PLAYER);
        if (lastLogged) {
            name.innerText += lastLogged;
            return;
        }
        else if(getLastNameIndex()) {
            name.innerText += getCookie(`player${getLastNameIndex()}`);
        }
    };

    function getLastNameIndex() {
        const cookies = document.cookie.split(";");
        return cookies.length-1;
    }


    function getCookie(name) {
        let matches = document.cookie.match(new RegExp(
            "(?:^|; )" + name.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g, '\\$1') + "=([^;]*)"
        ));
        return matches ? decodeURIComponent(matches[1]) : undefined;
    }
</script>

</body>
</html>